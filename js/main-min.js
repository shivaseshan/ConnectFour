var GameModule=function(){"use strict";var e,t,r;e=document.getElementById("board");var o=function(e,t){this.matrix=[],this.row=e,this.column=t,this.height=[]};o.prototype.createBoard=function(){var e,t;for(e=0;e<this.row;e+=1)for(this.matrix[e]=[],t=0;t<this.column;t+=1)this.matrix[e].push(0)},o.prototype.drawBoard=function(){var t,r,o,a,i,n,d;for(t=0;t<=this.row;t+=1)i=document.createElement("DIV"),i.className="row",i.setAttribute("row",t),e.appendChild(i);for(a=e.children,r=0;r<a.length;r+=1)for(o=a[r],t=0;t<this.column;t+=1)n=document.createElement("DIV"),n.className="cell",n.setAttribute("column",t),o.appendChild(n),d=document.createElement("DIV"),d.className="piece",n.appendChild(d)},o.prototype.setHeight=function(){var e,t=[];for(e=0;e<this.column;e+=1)t[e]=this.row-1;this.height=t},o.prototype.isBoardFull=function(){var e,t;for(e=0;e<this.column;e+=1){if(-1!==this.height[e]){t=!1;break}t=!0}return t&&window.alert("Board is full and the game is tie!"),t};var a=function(e,t){this.color=t,this.name=e},i=function(e,t){this.gameStarted=!1,this.gameOver=!1,this.board=null,this.player1=null,this.player2=null,this.init(e,t)};i.prototype.init=function(e,t){this.board=new o(e,t),this.board.createBoard(),this.board.drawBoard(),this.board.setHeight()},i.prototype.startGame=function(e,t){this.gameStarted=!0,this.player1=new a("player1",e),this.player2=new a("player2",t),document.getElementById("player1-color").setAttribute("disabled",""),document.getElementById("player2-color").setAttribute("disabled",""),document.getElementById("player1").className="active-player",document.getElementById("player2").className="inactive-player",document.getElementById("start").setAttribute("disabled","")},i.prototype.reset=function(){this.gameStarted=!1,this.gameOver=!1,this.resetDOM(),this.init(6,7)},i.prototype.resetDOM=function(){window.clearInterval(r),document.getElementById("start").removeAttribute("disabled"),document.getElementById("player1-color").removeAttribute("disabled"),document.getElementById("player2-color").removeAttribute("disabled"),document.getElementById("player1-color").value="",document.getElementById("player2-color").value="",document.getElementById("player1").className="reset-player",document.getElementById("player2").className="reset-player",document.getElementById("player1-win").className="hidden",document.getElementById("player2-win").className="hidden",e.innerHTML=""},i.prototype.move=function(e,t){var r,o;return r=this.board.height[e],r>=0?(this.board.matrix[r][e]=t,this.board.height[e]-=1,o=!0):(window.alert("Illegal move. There is no space in column "+(parseInt(e,10)+1)),o=!1),o},i.prototype.drawPiece=function(t,r){e.children[this.board.height[t]+2].childNodes[t].childNodes[0].style.backgroundColor=r},i.prototype.checkWinningCombination=function(e){var t,r;for(t=0;t<this.board.row;t+=1)for(r=0;r<this.board.column-3;r+=1)if(this.board.matrix[t][r]===e&&this.board.matrix[t][r+1]===e&&this.board.matrix[t][r+2]===e&&this.board.matrix[t][r+3]===e)return{winnerColor:e,squares:[[t,r],[t,r+1],[t,r+2],[t,r+3]]};for(t=this.board.row-1;t>2;t-=1)for(r=0;r<this.board.column;r+=1)if(this.board.matrix[t][r]===e&&this.board.matrix[t-1][r]===e&&this.board.matrix[t-2][r]===e&&this.board.matrix[t-3][r]===e)return{winnerColor:e,squares:[[t,r],[t-1,r],[t-2,r],[t-3,r]]};for(t=0;t<this.board.row-3;t+=1)for(r=0;r<this.board.column-3;r+=1)if(this.board.matrix[t][r]===e&&this.board.matrix[t+1][r+1]===e&&this.board.matrix[t+2][r+2]===e&&this.board.matrix[t+3][r+3]===e)return{winnerColor:e,squares:[[t,r],[t+1,r+1],[t+2,r+2],[t+3,r+3]]};for(t=this.board.row-1;t>2;t-=1)for(r=0;r<this.board.column-3;r+=1)if(this.board.matrix[t][r]===e&&this.board.matrix[t-1][r+1]===e&&this.board.matrix[t-2][r+2]===e&&this.board.matrix[t-3][r+3]===e)return{winnerColor:e,squares:[[t,r],[t-1,r+1],[t-2,r+2],[t-3,r+3]]};return!1};var n=new i(6,7),d=function(){var e=document.getElementById("player1-color"),r=document.getElementById("player2-color");return""===e.value||""===r.value?(window.alert("Please select both player's color"),!1):(n.startGame(e.value,r.value),t=n.player1,!0)},l=function(){var e;for(e=0;e<arguments.length;e+=1)arguments[e]instanceof GameModule.Game&&(n=arguments[e]);return n.gameStarted?n.gameOver?(n.reset(),!0):window.confirm("Are you sure you want to Quit ?")?(n.reset(),!0):void 0:!1},s=function(t){var r,o;for(o=t||-1,r=0;r<n.board.column;r+=1)r!==parseInt(o,10)&&(e.children[0].childNodes[r].childNodes[0].style.backgroundColor="",e.children[0].childNodes[r].childNodes[0].style.boxShadow="")},c=function(r){var o;n.gameStarted&&!n.gameOver&&(o=r.target.getAttribute("column")||r.target.parentNode.getAttribute("column"),o&&(e.children[0].childNodes[o].childNodes[0].style.backgroundColor=t.color,e.children[0].childNodes[o].childNodes[0].style.boxShadow="10px 10px 5px #888888",s(o)))},m=function(o){var a,i,d,l,c;if(!n.gameOver&&n.gameStarted&&(d=o.target.getAttribute("column")||o.target.parentNode.getAttribute("column"))){if(!n.move(d,t.color))return;if(n.drawPiece(d,t.color),n.board.isBoardFull())return void(document.getElementById(t.name).className="inactive-player");if(l=n.checkWinningCombination(t.color))return s(),r=window.setInterval(function(){for(a=0;a<l.squares.length;a+=1)i=l.squares[a][0],d=l.squares[a][1],e.children[i+1].childNodes[d].style.backgroundColor=""===e.children[i+1].childNodes[d].style.backgroundColor?"aqua":""},500),window.alert(l.winnerColor===n.player1.color?"Player 1 wins":"Player 2 wins"),e.children[0].childNodes[d].childNodes[0].style.backgroundColor="",e.children[0].childNodes[d].childNodes[0].style.boxShadow="",document.getElementById(t.name).className+=" animation",document.getElementById(t.name+"-win").className="",void(n.gameOver=!0);c=t,t=t===n.player1?n.player2:n.player1,e.children[0].childNodes[d].childNodes[0].style.backgroundColor="",e.children[0].childNodes[d].childNodes[0].style.boxShadow="",document.getElementById(c.name).className="inactive-player",document.getElementById(t.name).className="active-player"}},u=function(e,t,r){t&&(t.addEventListener?t.addEventListener(e,r,!1):t.attachEvent&&t.attachEvent("on"+e,r))};return u("click",document.getElementById("start"),d),u("click",document.getElementById("reset"),l),u("click",document.getElementById("board"),m),u("mouseover",document.getElementById("board"),c),u("mouseout",document.getElementById("board"),s),{validation:d,Player:a,Board:o,Game:i,reset:l}}();